name: Tarea Diaria de Scripts

on:
  schedule:
    - cron: '0 9 * * *' 
  workflow_dispatch: 

jobs:
  ejecutar_script:
    runs-on: ubuntu-latest 
    
    # Damos permiso explícito al token para escribir en el repo
    permissions:
      contents: write

    steps:
    - name: 1. Checkout del código
      uses: actions/checkout@v4 
    
    - name: 2. Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10' 

    - name: 3. Instalar dependencias
      run: |
        pip install yfinance pandas
        
    - name: 4. Ejecutar Script principal
      # Esto crea el archivo 'ejecuciones_log.txt' en la VM
      run: python tu_script.py

    - name: 5. Guardar cambios (Git Scraping)
      run: |
        # Configuramos el "bot" que firmará el commit
        git config user.name "Automated Action"
        git config user.email "actions@users.noreply.github.com"
        
        # Agregamos el archivo generado (o todos los cambios)
        git add ejecuciones_log.txt
        
        # Hacemos commit si hay cambios (el '|| exit 0' evita error si no hubo cambios)
        git commit -m "Auto: Actualización de log diario" || exit 0
        
        # Enviamos los cambios de vuelta a tu repo
        git push
